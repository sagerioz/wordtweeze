<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="bootstrap-3.3.7/docs/favicon.ico">

  <title>WordTweeze</title>

  <!-- Bootstrap core CSS -->
  <link href="bootstrap-3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="bootstrap-3.3.7/docs/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/dashboard.css" rel="stylesheet">

  <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
  <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
  <script src="bootstrap-3.3.7/docs/assets/js/ie-emulation-modes-warning.js"></script>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  <!--- Google Fonts ------------------------->
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Sorts+Mill+Goudy" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">

  <!-- Main Quill library -->
  <script src="https://cdn.quilljs.com/1.2.0/quill.js"></script>
  <script src="https://cdn.quilljs.com/1.2.0/quill.min.js"></script>

  <!-- Theme included stylesheets for Quill -->
  <link href="https://cdn.quilljs.com/1.2.0/quill.snow.css" rel="stylesheet">
  <link href="https://cdn.quilljs.com/1.2.0/quill.bubble.css" rel="stylesheet">

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

  <!-- Javascript -->
  <script type="text/javascript" src="project1.js">
  </script>

  <!-- css -->
  <link rel="stylesheet" href="./css/project1.css">

</head>

<body>

  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        <a class="navbar-brand" href="./index.html" id="logo">WordTweeze</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-left">
          <li><a href="./index.html">Text Editor</a></li>
          <li><a href="./profile.html">Profile</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-3 col-md-2 sidebar">
        <ul class="nav nav-sidebar">
          <li class="active"><a href="./overview.html">Overview <span class="sr-only">(current)</span></a></li>
        </ul>
        <ul class="nav nav-sidebar" id="nav_sidebar_actions">
          <li><a href="" id="definitions">More Definitions</a></li>
          <li><a href="" id="example">Example</a></li>
          <li><a href="#" data-toggle="dropdown" class="dropdown-toggle">Related Words <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="#" id="synonym">synonym</a></li>
              <li><a href="#" id="antonym">antonym</a></li>
              <li><a href="#" id="same-context">same-context</a></li>
              <li><a href="#" id="etymology">etymology</a></li>
              <li><a href="#" id="crossRef">cross-reference</a></li>
            </ul>
          </li>
          <li><a href="" id="pronunciation">Pronunciation</a></li>
          <li><a href="" id="rhymes">Rhyming</a></li>
          <li><a href="#" id="clear">Clear Results</a></li>
        </ul>
        <ul class="nav nav-sidebar" id="second_nav_sidebar_actions">
          <li><a href="" id="WOTD">Word of the Day</a></li>
          <li><a href="#" data-toggle="dropdown" class="dropdown-toggle-favs">Favorite Words<b class="caret"></b></a>
            <ul class="dropdown-menu" id="addfav">
              <li><a href="#" class="addfav">&#9734; make your list!</a></li>
            </ul>
          </li>
      </div>
      <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        <!-- <span class="favorite-star-character" id="star"></span> -->

        <form class="navbar-form navbar-right">
          <input type="text" class="form-control" placeholder="tweeze a word">
          <button type="button" class="btn btn-default btn-sm" id="search"><span class="glyphicon glyphicon-ok"></span> </button>
        </form>
        <h1 class="page-header" id="mainTitle">Tweeze Editor</h1>
        <span class="favorite-star-character" id="star"></span>
        <div id="displayDiv">

          <!-- Create the quill editor container -->
          <!-- ====================================================================== -->

          <div id="toolbar">
          </div>
          <div id="quillEditor">
          </div>
          <!-- <button type="button" name="butnSave" id="saveDelta" class="btn btn-default btn-sm">Save</button> -->
          <button type="button" name="" id="butnCount" class="btn btn-default btn-sm">Word Frequency</button>
          <a href="" id="a">click here to download your file</a>
          <button onclick="download('file text', 'tweeze.html', 'html')" class="btn btn-default btn-sm">Save</button>
          <input type="file" id="file-input" />
          <!-- <button onclick="readSingleFile(e)" class="btn btn-default btn-sm">Open file</button> -->
          <div id="appendFrequency"></div>


          <!-- Initialize Quill editor -->
          <!-- ====================================================================== -->

          <script type="text/javascript">
            var toolbarOptions = [
              ['bold', 'italic', 'underline', 'strike'],
              ['blockquote', 'code-block'],
              [{
                'list': 'ordered'
              }, {
                'list': 'bullet'
              }],
              [{
                'indent': '-1'
              }, {
                'indent': '+1'
              }],
              [{
                'size': ['small', false, 'large', 'huge']
              }],
              ['link', 'image', 'video', 'formula'],
              [{
                'color': []
              }, {
                'background': []
              }],
              [{
                'font': []
              }],
              [{
                'align': []
              }]


            ]
            var Clipboard = Quill.import('modules/clipboard');
            var Delta = Quill.import('delta');
            let delta1 = '';
            let text = '';
            let justHtml = '';
            var editor = new Quill('#quillEditor', {
              debug: 'info',
              modules: {
                toolbar: toolbarOptions
              },
              placeholder: 'Compose...',
              theme: 'snow',
            });

            editor.on('text-change', function() {
              $('#appendFrequency').empty()
              //$('#star').empty()
              //$('#star').empty()
              $('#star').innerHTML = '&#9734;'
            //  $('#star').html('')
            //  $("input").delay(100).fadeOut().fadeIn('slow')
              let countHolder = {}
              let txtArr = [];
              let keys = [];
              let delta1 = editor.getContents();
              let text = editor.getText();
              console.log("DELTA:", JSON.stringify(delta1), "TEXT:", text, "JUSTHTML:", justHtml);
              console.log("text??", delta1);
              const wordOccurenceCount = (text) => {
                txtArr = text.split(/\W+/)
                console.log("ARR", txtArr);
                for (var j = 0; j < txtArr.length; j++) {
                  let word = txtArr[j].toLowerCase()
                  console.log("WORD", word);
                   if (word) {

                    if (countHolder[word] === undefined) {
                     keys.push(word);
                      countHolder[word] = 1;
                    } else {
                      countHolder[word] = countHolder[word] + 1
                    }
                  }
                }

                const compare = (a, b) => {
                  let countA = countHolder[a]
                  let countB = countHolder[b]
                  return (countA - countB)
                }
                keys.sort(compare)
                console.log("THIS?", keys, countHolder);

                for (let i = 0; i < keys.length; i++) {
                  let key = keys[i]
                  $('#appendFrequency').addClass('freqClass')
                  $('#appendFrequency').prepend(`<p class="freq">'${key}': ${countHolder[key]} </p>`)
                }
              }

              $('#butnCount').click(function() {
                // delete previous object contents to begin new count
                for (var key in countHolder) {
                delete countHolder[key];
                }
                // delete html element to begin new count
                $('#appendFrequency').empty();
                  wordOccurenceCount(text)
                  console.log("TEXT!", text);
              })
            });

            function download(text, name, type) {
              var textRaw = editor.getContents();
              text = JSON.stringify(textRaw)
              var a = document.getElementById("a");
              var file = new Blob([text], {
                type: type
              });
              a.href = URL.createObjectURL(file);
              a.download = name;
            }

            function readSingleFile(e) {
              var file = e.target.files[0];
              if (!file) {
                return;
              }
              var reader = new FileReader();
              reader.onload = function(e) {
                var delta= e.target.result;
                console.log(delta);
                editor.setContents(delta)
                editor.updateContents(delta)
                editor.insertEmbed(delta)
                console.log("DELTA", delta);
              //  op.insert()
                console.log("I'm here");
                //displayContents(contents);
              };
              reader.readAsText(file);
            }

            function displayContents(contents) {
              var element = document.getElementById('quillEditor');
              editor.setContents(contents)
              element.innerHTML = contents;
            }

            document.getElementById('file-input')
              .addEventListener('change', readSingleFile, false);


            editor.clipboard.addMatcher(Node.ELEMENT_NODE, function(node, delta) {
              var plaintext = $(node).text();
              return new Delta().insert(plaintext);
            });

            editor.clipboard.addMatcher(Node.TEXT_NODE, function(node, delta) {
              return new Delta().insert(node.data);
            });

            function get_selection() {
              var txt = '';
              if (window.getSelection) {
                txt = window.getSelection();
              } else if (document.getSelection) {
                txt = document.getSelection();
              } else if (document.selection) {
                txt = document.selection.createRange().text;
              }
              return txt;
            }

            function SelectAll(id) {
              document.getElementById(id).focus();
              document.getElementById(id).select();
            }

            function copy() {
              SelectAll('textAreaID');
              document.execCommand("Copy", false, null);
            }
          </script>


          <ul class="nav" id="target_ul"></ul>
          <table class="table" id="main_table">
            <thead>
              <tr>
                <th></th>
                <th></th>
                <th></th>
              </tr>
            </thead>
            <tbody id="tbody">
            </tbody>
          </table>
        </div><br>

        <!-- end word count functionality -->
        <!-- ====================================================================== -->


        <!-- Bootstrap core JavaScript
    <!-- Placed at the end of the document so the pages load faster -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script>
          window.jQuery || document.write('<script src="bootstrap-3.3.7/docs/assets/js/vendor/jquery.min.js"><\/script>')
        </script>
        <script src="bootstrap-3.3.7/docs/dist/js/bootstrap.min.js"></script>
        <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
        <script src="bootstrap-3.3.7/docs/assets/js/vendor/holder.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="bootstrap-3.3.7/docs/assets/js/ie10-viewport-bug-workaround.js"></script>

</body>

</html>
